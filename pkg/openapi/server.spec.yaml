openapi: 3.0.3
info:
  title: Kubernetes Region Service API
  description: |-
    Cloud region discovery and routing service.
  version: 0.1.1
paths:
  /api/v1/organizations/{organizationID}/regions:
    description: |-
      Regions define a cloud.  This may be geographical or any logical partition.
      Either way this is the primitive that is used to associate metadata such as
      geographical locale, an organisation's reserved blob of compute etc.
      Each region has its own provider associated with it, for example OpenStack, and
      its own set of credentials so things can be scoped to a specific slice of a
      shared cloud through whatever mechanism is available on that cloud provider.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    get:
      description: |-
        List all regions.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/regionsResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/regions/{regionID}/flavors:
    description: Compute flavor services.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/regionIDParameter'
    get:
      description: |-
        Lists all compute flavors that the authenticated user has access to
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/flavorsResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/regions/{regionID}/images:
    description: Compute image services.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/regionIDParameter'
    get:
      description: |-
        Lists all compute images that the authenticated user has access to.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/imagesResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/regions/{regionID}/externalnetworks:
    description: |-
      Allows access to "external networks" for providers that support them.
      While CAPO can infer the external network itself, it craps out -
      as per usual - if more than one is found, wracked with indescision.
      Thus we still need to handle it as a special snowflake.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/regionIDParameter'
    get:
      description: Get a list of external networks.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/externalNetworksResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '404':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/notFoundResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/identities:
    description: |-
      Managed identity services.  Identities should be single use e.g. a single cluster instance.
      This limits blast radius in the event of a credential leak, or in some cases avoids bugs in
      provisioning software.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    get:
      description: Get all identites scoped to an organization.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/identitiesResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities:
    description: |-
      Managed identity services.  Identities should be single use e.g. a single cluster instance.
      This limits blast radius in the event of a credential leak, or in some cases avoids bugs in
      provisioning software.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    post:
      description: Create a new identity in the region.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/identityRequest'
      responses:
        '201':
          $ref: '#/components/responses/identityResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}:
    description: |-
      Managed identity services.  Identities should be single use e.g. a single cluster instance.
      This limits blast radius in the event of a credential leak, or in some cases avoids bugs in
      provisioning software.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    get:
      description: Get a single identity.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/identityResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    delete:
      description: Delete an identity and any resources associated with it.
      security:
      - oauth2Authentication: []
      responses:
        '202':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/acceptedResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '404':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/notFoundResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/quotas:
    description: |-
      Provides per-client quota management, to limit the scope within the identity and hide
      other clients from each other.  Aggregation is handled transparently by the controller.
      Please note that quotas cannot be enforced per-client, e.g. client A can accidentally
      use client B's allocation.  Client scoping is handled via the token subject, so it's
      important that callers be using service accounts, not end user tokens.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    get:
      description: A client-specific set of quotas for the identity.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/quotasResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    put:
      description: Set per-client quotas for the identity.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/quotasRequest'
      responses:
        '202':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/acceptedResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/networks:
    description: |-
      Manages networks.  Networks may be required for baremetal node provisioning e.g. a VLAN.
      Note that only a single network is currently supported per identity, as identities are
      intended to exist per piece of infrastructure.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    get:
      description: List networks.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/networksResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/networks:
    description: |-
      Manages networks.  Networks may be required for baremetal node provisioning e.g. a VLAN.
      Note that only a single network is currently supported per identity, as identities are
      intended to exist per piece of infrastructure.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    post:
      description: Create a new network.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/networkRequest'
      responses:
        '201':
          $ref: '#/components/responses/networkResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/networks/{networkID}:
    description: |-
      Manages networks.  Networks may be required for baremetal node provisioning e.g. a VLAN.
      Note that only a single network is currently supported per identity, as identities are
      intended to exist per piece of infrastructure.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    - $ref: '#/components/parameters/networkIDParameter'
    get:
      description: Get a phyiscal network.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/networkResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    delete:
      description: Delete a new network.
      security:
      - oauth2Authentication: []
      responses:
        '202':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/acceptedResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/securitygroups:
    description: |-
      Manages security groups. Security group acts as a virtual firewall for instances to control 
      inbound and outbound traffic.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    get:
      description: List security groups.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/securityGroupsResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/securitygroups:
    description: |-
      Manages security groups. Security group acts as a virtual firewall for instances to control 
      inbound and outbound traffic.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    post:
      description: Create a new security group.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/securityGroupRequest'
      responses:
        '201':
          $ref: '#/components/responses/securityGroupResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/securitygroups/{securityGroupID}:
    description: |-
      Manages security groups. Security group acts as a virtual firewall for instances to control 
      inbound and outbound traffic.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    - $ref: '#/components/parameters/securityGroupIDParameter'
    get:
      description: Get a security group.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/securityGroupResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    put:
      description: Updates a security group.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/securityGroupRequest'
      responses:
        '202':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/acceptedResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    delete:
      description: Delete a security group.
      security:
      - oauth2Authentication: []
      responses:
        '202':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/acceptedResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/securitygroups/{securityGroupID}/rules:
    description: |-
      Manages security groups rules. Security group acts as a virtual firewall for instances to control 
      inbound and outbound traffic.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    - $ref: '#/components/parameters/securityGroupIDParameter'
    get:
      description: List security groups rules.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/securityGroupRulesResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    post:
      description: Create a new security group rule.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/securityGroupRuleRequest'
      responses:
        '201':
          $ref: '#/components/responses/securityGroupRuleResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/securitygroups/{securityGroupID}/rules/{ruleID}:
    description: |-
      Manages security groups rules. Security group acts as a virtual firewall for instances to control 
      inbound and outbound traffic.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    - $ref: '#/components/parameters/securityGroupIDParameter'
    - $ref: '#/components/parameters/ruleIDParameter'
    get:
      description: Get a security group rule.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/securityGroupRuleResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    delete:
      description: Delete a security group rule.
      security:
      - oauth2Authentication: []
      responses:
        '202':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/acceptedResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/servers:
    description: |-
      Manages servers.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    get:
      description: List servers.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/serversResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/servers:
    description: |-
      Manages servers.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    post:
      description: Create a new server.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/serverRequest'
      responses:
        '201':
          $ref: '#/components/responses/serverResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/servers/{serverID}:
    description: |-
      Manages servers.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    - $ref: '#/components/parameters/serverIDParameter'
    get:
      description: Get a server.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/serverResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    delete:
      description: Delete a server.
      security:
      - oauth2Authentication: []
      responses:
        '202':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/acceptedResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
components:
  parameters:
    organizationIDParameter:
      name: organizationID
      in: path
      description: An organization ID.
      required: true
      schema:
        type: string
    projectIDParameter:
      name: projectID
      in: path
      description: |-
        The project name.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    regionIDParameter:
      name: regionID
      in: path
      description: The region identifier.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    identityIDParameter:
      name: identityID
      in: path
      description: The identity identifier.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    networkIDParameter:
      name: networkID
      in: path
      description: The network identifier.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    clientIDParameter:
      name: clientID
      in: path
      description: The client a resource belongs to.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    securityGroupIDParameter:
      name: securityGroupID
      in: path
      description: The security group identifier.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    ruleIDParameter:
      name: ruleID
      in: path
      description: The security group rule identifier.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    serverIDParameter:
      name: serverID
      in: path
      description: The server identifier.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
  schemas:
    kubernetesNameParameter:
      description: A Kubernetes name. Must be a valid DNS containing only lower case characters, numbers or hyphens, start and end with a character or number, and be at most 63 characters in length.
      type: string
      minLength: 1
      maxLength: 63
    regionType:
      description: The region's provider type.
      type: string
      enum:
      - openstack
    regionFeatures:
      description: A set of features the region may provide to clients.
      type: object
      required:
      - physicalNetworks
      properties:
        physicalNetworks:
          description: |
            If set, this indicates that the region supports physical networks and
            one should be provisioned for clusters to use.  The impliciation here is
            the region supports base-metal machines, and these must be provisioned
            on a physical VLAN etc.
          type: boolean
    regionSpec:
      description: Information about the region.
      type: object
      required:
      - type
      - features
      properties:
        type:
          $ref: '#/components/schemas/regionType'
        features:
          $ref: '#/components/schemas/regionFeatures'
    regionRead:
      description: A region.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceReadMetadata'
        spec:
          $ref: '#/components/schemas/regionSpec'
    regions:
      description: A list of regions.
      type: array
      items:
        $ref: '#/components/schemas/regionRead'
    imageVirtualization:
      description: What type of machine the image is for.
      type: string
      enum:
      - virtualized
      - baremetal
      - any
    softwareVersions:
      description: Image preinstalled version version metadata.
      type: object
      additionalProperties:
        $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/semver'
    gpuVendor:
      description: The GPU vendor.
      type: string
      enum:
      - NVIDIA
      - AMD
    gpuModel:
      description: A GPU model number.
      type: string
    gpuModelList:
      description: A list of GPU model numbers.
      type: array
      items:
        $ref: '#/components/schemas/gpuModel'
    imageGpu:
      description: The GPU driver if installed.
      type: object
      required:
      - vendor
      - driver
      properties:
        vendor:
          $ref: '#/components/schemas/gpuVendor'
        driver:
          description: The GPU driver version, this is vendor specific.
          type: string
        models:
          $ref: '#/components/schemas/gpuModelList'
    osKernel:
      description: A kernel type.
      type: string
      enum:
      - linux
    osFamily:
      description: A family of operating systems.  This typically defines the package format.
      type: string
      enum:
      - redhat
      - debian
    osDistro:
      description: A distribution name.
      type: string
      enum:
      - rocky
      - ubuntu
    imageOS:
      description: An operating system description.
      type: object
      required:
      - kernel
      - family
      - distro
      - version
      properties:
        kernel:
          $ref: '#/components/schemas/osKernel'
        family:
          $ref: '#/components/schemas/osFamily'
        distro:
          $ref: '#/components/schemas/osDistro'
        variant:
          description: A free form variant e.g. desktop/server.
          type: string
        codename:
          description: A free form code name e.g. warty/bionic.
          type: string
        version:
          description: Version of the operating system e.g. "24.04".
          type: string
    imageSpec:
      description: An image.
      type: object
      required:
      - sizeGiB
      - virtualization
      - os
      properties:
        sizeGiB:
          description: Minimum disk size required to use the image in GiB.
          type: integer
        virtualization:
          $ref: '#/components/schemas/imageVirtualization'
        os:
          $ref: '#/components/schemas/imageOS'
        softwareVersions:
          $ref: '#/components/schemas/softwareVersions'
        gpu:
          $ref: '#/components/schemas/imageGpu'
    image:
      description: An image.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          type: string
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/staticResourceMetadata'
        spec:
          type: string
          $ref: '#/components/schemas/imageSpec'
    images:
      description: A list of images that are compatible with this platform.
      type: array
      items:
        $ref: '#/components/schemas/image'
    gpuSpec:
      description: GPU specification.
      type: object
      required:
      - vendor
      - model
      - memory
      - physicalCount
      - logicalCount
      properties:
        vendor:
          $ref: '#/components/schemas/gpuVendor'
        model:
          description: A GPU model.
          type: string
        memory:
          description: GPU memory in GiB.
          type: integer
        physicalCount:
          description: The physical number of GPUs (cards) available.
          type: integer
        logicalCount:
          description: The logical number of GPUs available as seen in the OS.
          type: integer
    flavorSpec:
      description: A flavor.
      type: object
      required:
      - cpus
      - memory
      - disk
      properties:
        baremetal:
          description: Whether the flavor is for a dedicated machine.
          type: boolean
        cpus:
          description: The number of CPUs.
          type: integer
        cpuFamily:
          description: A free form CPU family description e.g. model number, architecture.
          type: string
        memory:
          description: The amount of memory in GiB.
          type: integer
        disk:
          description: The amount of ephemeral disk in GB.
          type: integer
        gpu:
          $ref: '#/components/schemas/gpuSpec'
    flavor:
      description: A flavor.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/staticResourceMetadata'
        spec:
          $ref: '#/components/schemas/flavorSpec'
    flavors:
      description: A list of flavors.
      type: array
      items:
        $ref: '#/components/schemas/flavor'
    identityWriteSpec:
      description: Request parameters for creating an identity.
      type: object
      required:
      - regionId
      properties:
        regionId:
          description: The region an identity is provisioned in.
          type: string
    identityWrite:
      description: An identity request.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceWriteMetadata'
        spec:
          $ref: '#/components/schemas/identityWriteSpec'
    identitySpecOpenStack:
      description: Everything an OpenStack client needs to function.
      type: object
      properties:
        cloud:
          description: The name of the cloud in the cloud config.
          type: string
        cloudConfig:
          description: A base64 encoded cloud config file.
          type: string
        userId:
          description: User identitifer allocated for the infrastructure.
          type: string
        projectId:
          description: Project identifier allocated for the infrastructure.
          type: string
        serverGroupId:
          description: Server group identifier allocated for the intrastructure.
          type: string
        sshKeyName:
          description: Ephemeral SSH key generated for the identity.
          type: string
    identitySpec:
      description: |-
        A provider specific identity, while the client can list regions to infer the
        type, we don't requires this and return it with the response.  That can then
        be used in turn to determine which provider specification to examine.
      type: object
      required:
      - type
      - regionId
      properties:
        type:
          $ref: '#/components/schemas/regionType'
        regionId:
          description: The region an identity is provisioned in.
          type: string
        openstack:
          $ref: '#/components/schemas/identitySpecOpenStack'
    identityRead:
      description: A provider specific identity.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/projectScopedResourceReadMetadata'
        spec:
          $ref: '#/components/schemas/identitySpec'
    identitiesRead:
      description: A list of provider specific identities.
      type: array
      items:
        $ref: '#/components/schemas/identityRead'
    ipv4Address:
      description: An IPv4 address.
      type: string
    ipv4AddressList:
      description: A list of IPv4 addresses.
      type: array
      items:
        $ref: "#/components/schemas/ipv4Address"
    networkReadSpec:
      description: A phyical network's specification.
      type: object
      required:
      - regionId
      - prefix
      - dnsNameservers
      - type
      properties:
        prefix:
          description: An IPv4 prefix for the network.
          type: string
        dnsNameservers:
          $ref: '#/components/schemas/ipv4AddressList'
        type:
          $ref: '#/components/schemas/regionType'
        regionId:
          description: The region an identity is provisioned in.
          type: string
        openstack:
          $ref: '#/components/schemas/networkSpecOpenstack'
    networkSpecOpenstack:
      description: An openstack network.
      properties:
        vlanId:
          description: The allocated VLAN ID.
          type: integer
        networkId:
          description: The openstack network ID.
          type: string
        subnetId:
          description: The openstack subnet ID.
          type: string
        routerId:
          description: The openstack router ID.
          type: string
    networkWriteSpec:
      description: A phyical network's specification.
      type: object
      required:
      - prefix
      - dnsNameservers
      properties:
        prefix:
          description: An IPv4 prefix for the network.
          type: string
        dnsNameservers:
          $ref: '#/components/schemas/ipv4AddressList'
    networkWrite:
      description: A network request.
      type: object
      required:
      - metadata
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceWriteMetadata'
        spec:
          $ref: '#/components/schemas/networkWriteSpec'
    networkRead:
      description: A network.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/projectScopedResourceReadMetadata'
        spec:
          $ref: '#/components/schemas/networkReadSpec'
    networksRead:
      description: A list of networks.
      type: array
      items:
        $ref: '#/components/schemas/networkRead'
    externalNetwork:
      description: An Openstack external network.
      type: object
      required:
      - id
      - name
      properties:
        id:
          description: The resource ID.
          type: string
        name:
          description: The resource name.
          type: string
    externalNetworks:
      description: A list of openstack external networks.
      type: array
      items:
        $ref: '#/components/schemas/externalNetwork'
    flavorQuota:
      description: A flavor quota.
      type: object
      required:
      - id
      - count
      properties:
        id:
          description: The flavor ID.
          type: string
        count:
          description: The number of the required flavor.
          type: integer
    flavorQuotaList:
      description: A list of flavor quotas.
      type: array
      items:
        $ref: '#/components/schemas/flavorQuota'
    quotasSpec:
      type: object
      properties:
        flavors:
          $ref: '#/components/schemas/flavorQuotaList'
    securityGroupRulePort:
      description: The port definition to allow traffic.
      type: object
      properties:
        number:
          description: The port to allow.
          type: integer
        range:
          $ref: '#/components/schemas/securityGroupRulePortRange'
    securityGroupRulePortRange:
      description: The port range to allow traffic.
      type: object
      required:
      - start
      - end
      properties:
        start:
          description: The start of the port range.
          type: integer
        end:
          description: The end of the port range.
          type: integer
    securityGroupRuleWriteSpec:
      description: A security group rule's specification.
      type: object
      required:
      - direction
      - protocol
      - port
      - cidr
      properties:
        direction:
          description: The direction of the rule.
          type: string
          enum:
          - ingress
          - egress
        protocol:
          description: The protocol to allow.
          type: string
          enum:
          - tcp
          - udp
        port:
          $ref: '#/components/schemas/securityGroupRulePort'
        cidr:
          $ref: '#/components/schemas/ipv4Address'
    securityGroupRuleWrite:
      description: A security group rule request.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceWriteMetadata'
        spec:
          $ref: '#/components/schemas/securityGroupRuleWriteSpec'
    securityGroupRuleReadSpec:
      description: A security group rule's specification.
      type: object
      required:
      - direction
      - protocol
      - port
      - cidr
      properties:
        direction:
          description: The direction of the rule.
          type: string
          enum:
          - ingress
          - egress
        protocol:
          description: The protocol to allow.
          type: string
          enum:
          - tcp
          - udp
        port:
          $ref: '#/components/schemas/securityGroupRulePort'
        cidr:
          $ref: '#/components/schemas/ipv4Address'
    securityGroupRuleRead:
      description: A security group rule.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/projectScopedResourceReadMetadata'
        spec:
          $ref: '#/components/schemas/securityGroupRuleReadSpec'
    securityGroupRulesRead:
      description: A list of security group rules.
      type: array
      items:
        $ref: '#/components/schemas/securityGroupRuleRead'
    securityGroupWriteSpec:
      description: A security group's specification.
      type: object
    securityGroupReadSpec:
      description: A security group's specification.
      type: object
      required:
      - regionId
      properties:
        regionId:
          description: The region an identity is provisioned in.
          type: string
    securityGroupWrite:
      description: A security group request.
      type: object
      required:
      - metadata
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceWriteMetadata'
        spec:
          $ref: '#/components/schemas/securityGroupWriteSpec'
    securityGroupRead:
      description: A security group.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/projectScopedResourceReadMetadata'
        spec:
          $ref: '#/components/schemas/securityGroupReadSpec'
    securityGroupsRead:
      description: A list of security groups.
      type: array
      items:
        $ref: '#/components/schemas/securityGroupRead'
    serverReadSpec:
      description: A server's specification.
      type: object
      required:
      - flavorId
      - image
      - networks
      properties:
        flavorId:
          description: The flavor of the server.
          type: string
        image:
          $ref: '#/components/schemas/serverImage'
        securityGroups:
          $ref: '#/components/schemas/serverSecurityGroupList'
        publicIPAllocation:
          $ref: '#/components/schemas/serverPublicIPAllocation'
        networks:
          $ref: '#/components/schemas/serverNetworkList'
        userData:
          description: UserData contains base64-encoded configuration information or scripts to use upon launch.
          type: string
          format: byte 
    serverNetworkList:
      description: A list of networks.
      type: array
      minItems: 1
      # NOTE: this is pinned due to cascading deletion semantics, for now.
      maxItems: 1
      items:
        $ref: '#/components/schemas/serverNetwork'
    serverNetwork:
      description: The server's network.
      type: object
      required:
      - id
      properties:
        id:
          description: Network to attach the server to
          type: string
    serverPublicIPAllocation:
      description: The server's public IP allocation.
      type: object
      required:
      - enabled
      properties:
        enabled:
          description: Whether to allocate a public IP.
          type: boolean
    serverSecurityGroupList:
      description: A list of security groups.
      type: array
      items:
        $ref: '#/components/schemas/serverSecurityGroup'
    serverSecurityGroup:
      description: A security group.
      type: object
      required:
      - id
      properties:
        id:
          description: The security group ID.
          type: string
    serverImage:
      description: The image to use for the server.
      type: object
      properties:
        id:
          description: The image ID.
          type: string
        selector:
          $ref: '#/components/schemas/serverImageSelector'
      oneOf:
      - required: [id]
      - required: [selector]
    serverImageSelector:
      description: A selector for an image.
      type: object
      required:
      - distro
      - version
      properties:
        distro:
          $ref: '#/components/schemas/osDistro'
        variant:
          description: A free form variant e.g. desktop/server.
          type: string
        version:
          description: Version of the operating system e.g. "24.04".
          type: string
        softwareVersions:
          $ref: '#/components/schemas/softwareVersions'
    serverReadStatus:
      description: A server's status.
      type: object
      properties:
        privateIP:
          description: The private IP address of the server.
          type: string
        publicIP:
          description: The public IP address of the server.
          type: string
    serverWriteSpec:
      description: A server's specification.
      type: object
      required:
      - flavorId
      - image
      - networks
      properties:
        flavorId:
          description: The flavor of the server.
          type: string
        image:
          $ref: '#/components/schemas/serverImage'
        securityGroups:
          $ref: '#/components/schemas/serverSecurityGroupList'
        publicIPAllocation:
          $ref: '#/components/schemas/serverPublicIPAllocation'
        networks:
          $ref: '#/components/schemas/serverNetworkList'
        userData:
          description: UserData contains base64-encoded configuration information or scripts to use upon launch.
          type: string
          format: byte 
    serverWrite:
      description: A server request.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceWriteMetadata'
        spec:
          $ref: '#/components/schemas/serverWriteSpec'
    serverRead:
      description: A server.
      type: object
      required:
      - metadata
      - spec
      - status
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/projectScopedResourceReadMetadata'
        spec:
          $ref: '#/components/schemas/serverReadSpec'
        status:
          $ref: '#/components/schemas/serverReadStatus'
    serversRead:
      description: A list of servers.
      type: array
      items:
        $ref: '#/components/schemas/serverRead'
  requestBodies:
    identityRequest:
      description: A request for an identity.
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/identityWrite'
          example:
            metadata:
              name: identity-name
              description: A verbose description
              tags:
              - name: cluster-id
                value: 9361402c-f998-49cc-ab21-9bb99afcfde8
            spec:
              regionId: c7568e2d-f9ab-453d-9a3a-51375f78426b
    networkRequest:
      description: A request for a network.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/networkWrite'
          example:
            metadata:
              name: network-name
              description: A verbose description
              tags:
              - name: cluster-id
                value: 9361402c-f998-49cc-ab21-9bb99afcfde8
            spec:
              prefix: 192.168.0.0/24
              dnsNameservers:
              - 8.8.8.8
    quotasRequest:
      description: A request to set quotas.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/quotasSpec'
          example:
            flavors:
            - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              count: 8
    securityGroupRequest:
      description: A request for a security group.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/securityGroupWrite'
          example:
            metadata:
              name: security-group-name
              description: A verbose description
              tags:
              - name: cluster-id
                value: 9361402c-f998-49cc-ab21-9bb99afcfde8
    securityGroupRuleRequest:
      description: A request for a security group rule.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/securityGroupRuleWrite'
          example:
            metadata:
              name: security-group-rule-name
              description: A verbose description
            spec:
              direction: ingress
              protocol: tcp
              port:
                number: 80
              cidr: 172.16.0.0/12
    serverRequest:
      description: A request for a server.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/serverWrite'
          example:
            metadata:
              name: server-name
              description: A verbose description
              tags:
              - name: tag-name
                value: tag-value
            spec:
              flavorId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              image:
                id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              securityGroups:
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9e
              publicIPAllocation:
                enabled: true
              networks:
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              userData: I2Nsb3VkLWNvbmZpZwpib290Y21kOgogLSBlY2hvIDE5Mi4xNjguMi45OSBteWhvc3QgPj4gL2V0Yy9ob3N0cwpwYWNrYWdlX3VwZ3JhZGU6IHRydWUKcGFja2FnZXM6CiAtIHZpbQo=
  responses:
    regionsResponse:
      description: A list of regions.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/regions'
          example:
          - metadata:
              id: c7568e2d-f9ab-453d-9a3a-51375f78426b
              name: uk-west
              description: An oxymoronic tier-3 datacenter based in Liverpool.
              creationTime: 2023-07-31T10:45:45Z
              provisioningStatus: provisioned
            spec:
              type: openstack
              features:
                physicalNetworks: true
    imagesResponse:
      description: A list of images that are compatible with this platform.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/images'
          example:
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: ubu2204-v1.25.6-gpu-525.85.05-7ced4154
              creationTime: 2023-02-22T12:04:13Z
            spec:
              sizeGiB: 10
              virtualization: virtualized
              os:
                kernel: linux
                family: debian
                distro: ubuntu
                variant: server
                codename: noble
                version: '24.04'
              softwareVersions:
                kubernetes: v1.25.6
              gpu:
                vendor: NVIDIA
                driver: 525.85.05
                models:
                - A100
                - H100
                - H200
    flavorsResponse:
      description: A list of flavors.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/flavors'
          example:
          - metadata:
              id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              name: g.4.highmem.a100.1g.10gb
              creationTime: 1970-01-01T00:00:00Z
            spec:
              cpus: 4
              cpuFamily: Intel Xeon Platinum 8160T (Skylake)
              disk: 20
              memory: 32
              gpu:
                vendor: AMD
                model: Instinct MI250
                memory: 64
                physicalCount: 1
                logicalCount: 2
    identityResponse:
      description: An identity response.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/identityRead'
          example:
            metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: unused
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
            spec:
              regionId: d891dbf0-0a01-4efc-ae3a-5d77f6d3424b
              type: openstack
              openstack:
                cloud: default
                cloudConfig: dGhpcyBpcyBhIHRlc3QK
                projectId: eb9c92d937464d14bf87e50fa726380d
                userId: a19678a28126497dba24b54c96a064fa
                sshKeyNmae: foo
    identitiesResponse:
      description: A list of identites.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/identitiesRead'
          example:
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: unused
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
            spec:
              regionId: d891dbf0-0a01-4efc-ae3a-5d77f6d3424b
              type: openstack
              openstack:
                cloud: default
                cloudConfig: dGhpcyBpcyBhIHRlc3QK
                projectId: eb9c92d937464d14bf87e50fa726380d
                userId: a19678a28126497dba24b54c96a064fa
                sshKeyNmae: foo
    networkResponse:
      description: A network.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/networkRead'
          example:
            metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: unused
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
            spec:
              regionId: d891dbf0-0a01-4efc-ae3a-5d77f6d3424b
              prefix: 192.168.0.0/24
              dnsNameservers:
              - 8.8.8.8
              type: openstack
              openstack:
                vlanId: 1024
                networkId: 824e8c4c-5858-4b02-9906-390e34561bf3
    networksResponse:
      description: A list of networks.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/networksRead'
          example:
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: unused
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
            spec:
              regionId: d891dbf0-0a01-4efc-ae3a-5d77f6d3424b
              prefix: 192.168.0.0/24
              dnsNameservers:
              - 8.8.8.8
              type: openstack
              openstack:
                vlanId: 1024
                networkId: 824e8c4c-5858-4b02-9906-390e34561bf3
    externalNetworksResponse:
      description: A list of valid external networks.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/externalNetworks'
          example:
          - id: c3f92716-1fdc-4b7b-906e-4fe0154dfcdf
            name: foo
    quotasResponse:
      description: A set of quotas for a client.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/quotasSpec'
          example:
            flavors:
            - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              count: 8
    securityGroupResponse:
      description: A security group.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/securityGroupRead'
          example:
            metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: unused
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
            spec:
              regionId: d891dbf0-0a01-4efc-ae3a-5d77f6d3424b
    securityGroupsResponse:
      description: A list of security groups.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/securityGroupsRead'
          example:
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: unused
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
            spec:
              regionId: d891dbf0-0a01-4efc-ae3a-5d77f6d3424b
    securityGroupRuleResponse:
      description: A security group rule.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/securityGroupRuleRead'
          example:
            metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: sg-name
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
            spec:
              direction: ingress
              protocol: tcp
              port:
                range:
                  start: 1066
                  end: 1999
              cidr: 172.16.0.0/12
    securityGroupRulesResponse:
      description: A list of security group rules.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/securityGroupRulesRead'
          example:
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: sg-name
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
            spec:
              direction: ingress
              protocol: tcp
              port:
                range:
                  start: 1066
                  end: 1999
              cidr: 172.16.0.0/12
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7d
              name: sg-name
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
            spec:
              direction: ingress
              protocol: tcp
              port:
                number: 80
              cidr: 0.0.0.0/0
    serverResponse:
      description: A server.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/serverRead'
          example:
            metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: server-name
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              tags:
              - name: tag-name
                value: tag-value
            spec:
              flavorId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              image:
                id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              securityGroups:
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9e
              publicIPAllocation:
                enabled: true
              networks:
                - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              userData: I2Nsb3VkLWNvbmZpZwpib290Y21kOgogLSBlY2hvIDE5Mi4xNjguMi45OSBteWhvc3QgPj4gL2V0Yy9ob3N0cwpwYWNrYWdlX3VwZ3JhZGU6IHRydWUKcGFja2FnZXM6CiAtIHZpbQo=
            status:
              privateIP: 192.168.1.50
              publicIP: 142.250.66.196
    serversResponse:
      description: A list of servers.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/serversRead'
          example:
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: server-name
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              tags:
              - name: tag-name
                value: tag-value
            spec:
              flavorId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              image:
                id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              securityGroups:
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9e
              publicIPAllocation:
                enabled: true
              networks:
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              userData: I2Nsb3VkLWNvbmZpZwpib290Y21kOgogLSBlY2hvIDE5Mi4xNjguMi45OSBteWhvc3QgPj4gL2V0Yy9ob3N0cwpwYWNrYWdlX3VwZ3JhZGU6IHRydWUKcGFja2FnZXM6CiAtIHZpbQo=
            status:
              privateIP: 192.168.1.50
              publicIP: 142.250.66.196
  securitySchemes:
    oauth2Authentication:
      description: Operation requires OAuth2 bearer token authentication.
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://identity.unikorn-cloud.org/oauth2/v2/authorization
          tokenUrl: https://identity.unikorn-cloud.org/oauth2/v2/token
          scopes: {}
