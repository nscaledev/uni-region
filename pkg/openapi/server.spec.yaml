openapi: 3.0.3
info:
  title: Region Service API
  description: |-
    Cloud region discovery and routing service.  This is service not intended for direct access
    by end users.  Region related functionality is typically exposed by higher level services
    e.g. Compute and Kubernetes, that provide subsets of resources that are compatible with
    that service.
  version: 1.3.0
paths:
  /api/v1/organizations/{organizationID}/regions:
    description: |-
      Regions define a cloud.  This may be geographical or any logical partition.
      Either way, this is the primitive that is used to associate metadata such as
      geographical locale, an organization's reserved blob of compute etc.
      Each region has its own provider associated with it, for example OpenStack, and
      its own set of credentials so things can be scoped to a specific slice of a
      shared cloud through whatever mechanism is available on that cloud provider.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    get:
      description: |-
        List all regions.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/regionsResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/regions/{regionID}/detail:
    description: |-
      Retrieves admin-level region details.
      This API is intentionally separate from the main list regions API to limit
      unintentional leakage of sensitive credentials.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/regionIDParameter'
    get:
      description: |-
        Get a detailed view of the region.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/regionDetailResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '404':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/notFoundResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/regions/{regionID}/flavors:
    description: Compute flavor services.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/regionIDParameter'
    get:
      description: |-
        Lists all compute flavors.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/flavorsResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/regions/{regionID}/images:
    description: Compute image services.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/regionIDParameter'
    get:
      description: |-
        Lists all compute images.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/imagesResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/regions/{regionID}/externalnetworks:
    description: |-
      Allows access to "external networks" for providers that support them.
      While things like Cluster API can infer the external network itself,
      it will break if it detects more than one, so this allows us to be
      explicit in our selection.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/regionIDParameter'
    get:
      description: Get a list of external networks.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/externalNetworksResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '404':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/notFoundResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/identities:
    description: |-
      Identities are a limited scope set of credentials that can be used to provision
      infrastructure in the region.  These typically contain isolated service accounts
      and projects, with the minimum required privileges to allow infrastructure
      provisioning.  This forms the basis of a security domain and minimizes risk in
      the event of a credentials leak.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    get:
      description: Get all identities scoped to an organization.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/identitiesResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities:
    description: |-
      Identities are a limited scope set of credentials that can be used to provision
      infrastructure in the region.  These typically contain isolated service accounts
      and projects, with the minimum required privileges to allow infrastructure
      provisioning.  This forms the basis of a security domain and minimizes risk in
      the event of a credentials leak.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    post:
      description: Create a new identity in the region.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/identityRequest'
      responses:
        '201':
          $ref: '#/components/responses/identityResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}:
    description: |-
      Identities are a limited scope set of credentials that can be used to provision
      infrastructure in the region.  These typically contain isolated service accounts
      and projects, with the minimum required privileges to allow infrastructure
      provisioning.  This forms the basis of a security domain and minimizes risk in
      the event of a credentials leak.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    get:
      description: Get a single identity.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/identityResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    delete:
      description: Delete an identity and any resources associated with it.
      security:
      - oauth2Authentication: []
      responses:
        '202':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/acceptedResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '404':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/notFoundResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/networks:
    description: |-
      Manages networks.  Networks may be required for baremetal node provisioning e.g. a VLAN.
      Note that only a single network is currently supported per identity, as identities are
      intended to be provisioned per-cluster.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    get:
      description: List networks.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/networksResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/networks:
    description: |-
      Manages networks.  Networks may be required for baremetal node provisioning e.g. a VLAN.
      Note that only a single network is currently supported per identity, as identities are
      intended to be provisioned per-cluster.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    post:
      description: Create a new network.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/networkRequest'
      responses:
        '201':
          $ref: '#/components/responses/networkResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/networks/{networkID}:
    description: |-
      Manages networks.  Networks may be required for baremetal node provisioning e.g. a VLAN.
      Note that only a single network is currently supported per identity, as identities are
      intended to be provisioned per-cluster.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    - $ref: '#/components/parameters/networkIDParameter'
    get:
      description: Get a physical network.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/networkResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    delete:
      description: Delete a new network.
      security:
      - oauth2Authentication: []
      responses:
        '202':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/acceptedResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/securitygroups:
    description: |-
      Manages security groups. Security group acts as a virtual firewall for instances to control 
      inbound and outbound traffic.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/parameters/tagSelectorParameter'
    get:
      description: List security groups.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/securityGroupsResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/securitygroups:
    description: |-
      Manages security groups. Security group acts as a virtual firewall for instances to control 
      inbound and outbound traffic.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    post:
      description: Create a new security group.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/securityGroupRequest'
      responses:
        '201':
          $ref: '#/components/responses/securityGroupResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/securitygroups/{securityGroupID}:
    description: |-
      Manages security groups. Security group acts as a virtual firewall for instances to control 
      inbound and outbound traffic.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    - $ref: '#/components/parameters/securityGroupIDParameter'
    get:
      description: Get a security group.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/securityGroupResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    put:
      description: Updates a security group.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/securityGroupRequest'
      responses:
        '202':
          $ref: '#/components/responses/securityGroupResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    delete:
      description: Delete a security group.
      security:
      - oauth2Authentication: []
      responses:
        '202':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/acceptedResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/securitygroups/{securityGroupID}/rules:
    description: |-
      Manages security groups rules. Security group acts as a virtual firewall for instances to control 
      inbound and outbound traffic.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    - $ref: '#/components/parameters/securityGroupIDParameter'
    get:
      description: List security groups rules.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/securityGroupRulesResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    post:
      description: Create a new security group rule.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/securityGroupRuleRequest'
      responses:
        '201':
          $ref: '#/components/responses/securityGroupRuleResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/securitygroups/{securityGroupID}/rules/{ruleID}:
    description: |-
      Manages security groups rules. Security group acts as a virtual firewall for instances to control 
      inbound and outbound traffic.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    - $ref: '#/components/parameters/securityGroupIDParameter'
    - $ref: '#/components/parameters/ruleIDParameter'
    get:
      description: Get a security group rule.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/securityGroupRuleResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    delete:
      description: Delete a security group rule.
      security:
      - oauth2Authentication: []
      responses:
        '202':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/acceptedResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/servers:
    description: |-
      Manages servers.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/parameters/tagSelectorParameter'
    get:
      description: List servers.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/serversResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/servers:
    description: |-
      Manages servers.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    post:
      description: Create a new server.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/serverRequest'
      responses:
        '201':
          $ref: '#/components/responses/serverResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
  /api/v1/organizations/{organizationID}/projects/{projectID}/identities/{identityID}/servers/{serverID}:
    description: |-
      Manages servers.
    parameters:
    - $ref: '#/components/parameters/organizationIDParameter'
    - $ref: '#/components/parameters/projectIDParameter'
    - $ref: '#/components/parameters/identityIDParameter'
    - $ref: '#/components/parameters/serverIDParameter'
    get:
      description: Get a server.
      security:
      - oauth2Authentication: []
      responses:
        '200':
          $ref: '#/components/responses/serverResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    put:
      description: Update a server.
      security:
      - oauth2Authentication: []
      requestBody:
        $ref: '#/components/requestBodies/serverRequest'
      responses:
        '202':
          $ref: '#/components/responses/serverResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
    delete:
      description: Delete a server.
      security:
      - oauth2Authentication: []
      responses:
        '202':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/acceptedResponse'
        '400':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/badRequestResponse'
        '401':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/unauthorizedResponse'
        '403':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/forbiddenResponse'
        '500':
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/responses/internalServerErrorResponse'
components:
  parameters:
    organizationIDParameter:
      name: organizationID
      in: path
      description: An organization ID.
      required: true
      schema:
        type: string
    projectIDParameter:
      name: projectID
      in: path
      description: |-
        The project ID.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    regionIDParameter:
      name: regionID
      in: path
      description: The region ID.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    identityIDParameter:
      name: identityID
      in: path
      description: The identity ID.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    networkIDParameter:
      name: networkID
      in: path
      description: The network ID.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    securityGroupIDParameter:
      name: securityGroupID
      in: path
      description: The security group ID.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    ruleIDParameter:
      name: ruleID
      in: path
      description: The security group rule ID.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
    serverIDParameter:
      name: serverID
      in: path
      description: The server ID.
      required: true
      schema:
        $ref: '#/components/schemas/kubernetesNameParameter'
  schemas:
    kubernetesNameParameter:
      description: A Kubernetes name. Must be a valid DNS containing only lower case characters, numbers or hyphens, start and end with a character or number, and be at most 63 characters in length.
      type: string
      minLength: 1
      maxLength: 63
    regionType:
      description: The region's provider type.
      type: string
      enum:
      - openstack
      - kubernetes
    regionFeatures:
      description: A set of features the region may provide to clients.
      type: object
      required:
      - physicalNetworks
      properties:
        physicalNetworks:
          description: |
            If set, this indicates that the region supports physical networks and
            one should be provisioned for clusters to use.  The implication here is
            the region supports base-metal machines, and these must be provisioned
            on a physical VLAN etc.
          type: boolean
    regionSpec:
      description: Information about the region.
      type: object
      required:
      - type
      - features
      properties:
        type:
          $ref: '#/components/schemas/regionType'
        features:
          $ref: '#/components/schemas/regionFeatures'
    regionDetailKubernetes:
      description: Region specific information when the type is "kubernetes".
      type: object
      required:
      - kubeconfig
      properties:
        kubeconfig:
          description: The region's base64 encoded Kubernetes configuration file.
          type: string
        domainName:
          description: The region's requested domain name for consuming services.
          type: string
    regionDetailSpec:
      description: Information about the region.
      type: object
      required:
      - type
      - features
      properties:
        type:
          $ref: '#/components/schemas/regionType'
        kubernetes:
          $ref: '#/components/schemas/regionDetailKubernetes'
        features:
          $ref: '#/components/schemas/regionFeatures'
    regionRead:
      description: A region.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceReadMetadata'
        spec:
          $ref: '#/components/schemas/regionSpec'
    regionDetailRead:
      description: A region.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceReadMetadata'
        spec:
          $ref: '#/components/schemas/regionDetailSpec'
    regions:
      description: A list of regions.
      type: array
      items:
        $ref: '#/components/schemas/regionRead'
    imageVirtualization:
      description: What type of machine the image is for.
      type: string
      enum:
      - virtualized
      - baremetal
      - any
    softwareVersions:
      description: Image preinstalled version version metadata.
      type: object
      additionalProperties:
        $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/semver'
    gpuVendor:
      description: The GPU vendor.
      type: string
      enum:
      - NVIDIA
      - AMD
    gpuModel:
      description: A GPU model number.
      type: string
    gpuModelList:
      description: A list of GPU model numbers.
      type: array
      items:
        $ref: '#/components/schemas/gpuModel'
    imageGpu:
      description: The GPU driver if installed.
      type: object
      required:
      - vendor
      - driver
      properties:
        vendor:
          $ref: '#/components/schemas/gpuVendor'
        driver:
          description: The GPU driver version, this is vendor specific.
          type: string
        models:
          $ref: '#/components/schemas/gpuModelList'
    osKernel:
      description: A kernel type.
      type: string
      enum:
      - linux
    osFamily:
      description: A family of operating systems.  This typically defines the package format.
      type: string
      enum:
      - redhat
      - debian
    osDistro:
      description: A distribution name.
      type: string
      enum:
      - rocky
      - ubuntu
    imageOS:
      description: An operating system description.
      type: object
      required:
      - kernel
      - family
      - distro
      - version
      properties:
        kernel:
          $ref: '#/components/schemas/osKernel'
        family:
          $ref: '#/components/schemas/osFamily'
        distro:
          $ref: '#/components/schemas/osDistro'
        variant:
          description: A free form variant e.g. desktop/server.
          type: string
        codename:
          description: A free form code name e.g. warty/bionic.
          type: string
        version:
          description: Version of the operating system e.g. "24.04".
          type: string
    imageSpec:
      description: An image.
      type: object
      required:
      - sizeGiB
      - virtualization
      - os
      properties:
        sizeGiB:
          description: Minimum disk size required to use the image in GiB.
          type: integer
        virtualization:
          $ref: '#/components/schemas/imageVirtualization'
        os:
          $ref: '#/components/schemas/imageOS'
        softwareVersions:
          $ref: '#/components/schemas/softwareVersions'
        gpu:
          $ref: '#/components/schemas/imageGpu'
    image:
      description: An image.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          type: string
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/staticResourceMetadata'
        spec:
          type: string
          $ref: '#/components/schemas/imageSpec'
    images:
      description: A list of images that are compatible with this platform.
      type: array
      items:
        $ref: '#/components/schemas/image'
    gpuSpec:
      description: GPU specification.
      type: object
      required:
      - vendor
      - model
      - memory
      - physicalCount
      - logicalCount
      properties:
        vendor:
          $ref: '#/components/schemas/gpuVendor'
        model:
          description: A GPU model.
          type: string
        memory:
          description: GPU memory in GiB.
          type: integer
        physicalCount:
          description: The physical number of GPUs (cards) available.
          type: integer
        logicalCount:
          description: The logical number of GPUs available as seen in the OS.
          type: integer
    flavorSpec:
      description: A flavor.
      type: object
      required:
      - cpus
      - memory
      - disk
      properties:
        baremetal:
          description: Whether the flavor is for a dedicated machine.
          type: boolean
        cpus:
          description: The number of CPUs.
          type: integer
        cpuFamily:
          description: A free form CPU family description e.g. model number, architecture.
          type: string
        memory:
          description: The amount of memory in GiB.
          type: integer
        disk:
          description: The amount of ephemeral disk in GB.
          type: integer
        gpu:
          $ref: '#/components/schemas/gpuSpec'
    flavor:
      description: A flavor.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/staticResourceMetadata'
        spec:
          $ref: '#/components/schemas/flavorSpec'
    flavors:
      description: A list of flavors.
      type: array
      items:
        $ref: '#/components/schemas/flavor'
    identityWriteSpec:
      description: Request parameters for creating an identity.
      type: object
      required:
      - regionId
      properties:
        regionId:
          description: The region an identity is provisioned in.
          type: string
    identityWrite:
      description: An identity request.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceWriteMetadata'
        spec:
          $ref: '#/components/schemas/identityWriteSpec'
    identitySpecOpenStack:
      description: Everything an OpenStack client needs to function.
      type: object
      properties:
        cloud:
          description: The name of the cloud in the cloud config.
          type: string
        cloudConfig:
          description: A base64 encoded cloud config file.
          type: string
        userId:
          description: User identitifer allocated for the infrastructure.
          type: string
        projectId:
          description: Project identifier allocated for the infrastructure.
          type: string
        serverGroupId:
          description: Server group identifier allocated for the intrastructure.
          type: string
        sshKeyName:
          description: Ephemeral SSH key generated for the identity.
          type: string
        sshPrivateKey:
          description: Ephemeral SSH private key to be used by higher order services.
          type: string
    identitySpec:
      description: A provider specific identity.
      type: object
      required:
      - type
      - regionId
      properties:
        type:
          $ref: '#/components/schemas/regionType'
        regionId:
          description: The region an identity is provisioned in.
          type: string
        openstack:
          $ref: '#/components/schemas/identitySpecOpenStack'
    identityRead:
      description: A provider specific identity.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/projectScopedResourceReadMetadata'
        spec:
          $ref: '#/components/schemas/identitySpec'
    identitiesRead:
      description: A list of provider specific identities.
      type: array
      items:
        $ref: '#/components/schemas/identityRead'
    ipv4Address:
      description: An IPv4 address.
      type: string
    ipv4AddressList:
      description: A list of IPv4 addresses.
      type: array
      items:
        $ref: "#/components/schemas/ipv4Address"
    networkReadSpec:
      description: A physical network's specification.
      type: object
      required:
      - regionId
      - prefix
      - dnsNameservers
      - type
      properties:
        prefix:
          description: An IPv4 prefix for the network.
          type: string
        dnsNameservers:
          $ref: '#/components/schemas/ipv4AddressList'
        type:
          $ref: '#/components/schemas/regionType'
        regionId:
          description: The region an identity is provisioned in.
          type: string
        openstack:
          $ref: '#/components/schemas/networkSpecOpenstack'
    networkSpecOpenstack:
      description: An openstack network.
      properties:
        vlanId:
          description: The allocated VLAN ID.
          type: integer
        networkId:
          description: The openstack network ID.
          type: string
        subnetId:
          description: The openstack subnet ID.
          type: string
        routerId:
          description: The openstack router ID.
          type: string
    networkWriteSpec:
      description: A physical network's specification.
      type: object
      required:
      - prefix
      - dnsNameservers
      properties:
        prefix:
          description: An IPv4 prefix for the network.
          type: string
        dnsNameservers:
          $ref: '#/components/schemas/ipv4AddressList'
    networkWrite:
      description: A network request.
      type: object
      required:
      - metadata
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceWriteMetadata'
        spec:
          $ref: '#/components/schemas/networkWriteSpec'
    networkRead:
      description: A network.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/projectScopedResourceReadMetadata'
        spec:
          $ref: '#/components/schemas/networkReadSpec'
    networksRead:
      description: A list of networks.
      type: array
      items:
        $ref: '#/components/schemas/networkRead'
    externalNetwork:
      description: An Openstack external network.
      type: object
      required:
      - id
      - name
      properties:
        id:
          description: The resource ID.
          type: string
        name:
          description: The resource name.
          type: string
    externalNetworks:
      description: A list of openstack external networks.
      type: array
      items:
        $ref: '#/components/schemas/externalNetwork'
    securityGroupRulePort:
      description: The port definition to allow traffic.
      type: object
      properties:
        number:
          description: The port to allow.
          type: integer
        range:
          $ref: '#/components/schemas/securityGroupRulePortRange'
    securityGroupRulePortRange:
      description: The port range to allow traffic.
      type: object
      required:
      - start
      - end
      properties:
        start:
          description: The start of the port range.
          type: integer
        end:
          description: The end of the port range.
          type: integer
    networkDirection:
      description: The direction of the rule.
      type: string
      enum:
      - ingress
      - egress
    networkProtocol:
      description: The protocol to allow.
      type: string
      enum:
      - tcp
      - udp
    securityGroupRuleSpec:
      description: A security group rule's specification.
      type: object
      required:
      - direction
      - protocol
      - port
      - cidr
      properties:
        direction:
          $ref: '#/components/schemas/networkDirection'
        protocol:
          $ref: '#/components/schemas/networkProtocol'
        port:
          $ref: '#/components/schemas/securityGroupRulePort'
        cidr:
          $ref: '#/components/schemas/ipv4Address'
    securityGroupRuleWrite:
      description: A security group rule request.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceWriteMetadata'
        spec:
          $ref: '#/components/schemas/securityGroupRuleSpec'
    securityGroupRuleRead:
      description: A security group rule.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/projectScopedResourceReadMetadata'
        spec:
          $ref: '#/components/schemas/securityGroupRuleSpec'
    securityGroupRulesRead:
      description: A list of security group rules.
      type: array
      items:
        $ref: '#/components/schemas/securityGroupRuleRead'
    securityGroupWriteSpec:
      description: A security group's specification.
      type: object
    securityGroupReadSpec:
      description: A security group's specification.
      type: object
      required:
      - regionId
      properties:
        regionId:
          description: The region an identity is provisioned in.
          type: string
    securityGroupWrite:
      description: A security group request.
      type: object
      required:
      - metadata
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceWriteMetadata'
        spec:
          $ref: '#/components/schemas/securityGroupWriteSpec'
    securityGroupRead:
      description: A security group.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/projectScopedResourceReadMetadata'
        spec:
          $ref: '#/components/schemas/securityGroupReadSpec'
    securityGroupsRead:
      description: A list of security groups.
      type: array
      items:
        $ref: '#/components/schemas/securityGroupRead'
    serverSpec:
      description: A server's specification.
      type: object
      required:
      - flavorId
      - imageId
      - networks
      properties:
        flavorId:
          description: The flavor of the server.
          type: string
        imageId:
          description: The image of the server.
          type: string
        securityGroups:
          $ref: '#/components/schemas/serverSecurityGroupList'
        publicIPAllocation:
          $ref: '#/components/schemas/serverPublicIPAllocation'
        networks:
          $ref: '#/components/schemas/serverNetworkList'
        userData:
          description: UserData contains base64-encoded configuration information or scripts to use upon launch.
          type: string
          format: byte 
    serverNetworkList:
      description: A list of networks.
      type: array
      minItems: 1
      # NOTE: this is pinned due to cascading deletion semantics, for now.
      maxItems: 1
      items:
        $ref: '#/components/schemas/serverNetwork'
    serverNetwork:
      description: The server's network.
      type: object
      required:
      - id
      properties:
        id:
          description: Network to attach the server to
          type: string
        allowedAddressPairs:
          $ref: '#/components/schemas/serverNetworkAllowedAddressPairList'
    serverNetworkAllowedAddressPairList:
      description: A list of allowed address pairs.
      type: array
      items:
        $ref: '#/components/schemas/serverNetworkAllowedAddressPair'
    serverNetworkAllowedAddressPair:
      description: Allow multiple MAC/IP address (range) pairs to pass through this network port.
      type: object
      required:
      - cidr
      properties:
        cidr:
          description: The CIDR to allow.
          type: string
        macAddress:
          description: The MAC address to allow.
          type: string
    serverPublicIPAllocation:
      description: The server's public IP allocation.
      type: object
      required:
      - enabled
      properties:
        enabled:
          description: Whether to allocate a public IP.
          type: boolean
    serverSecurityGroupList:
      description: A list of security groups.
      type: array
      items:
        $ref: '#/components/schemas/serverSecurityGroup'
    serverSecurityGroup:
      description: A security group.
      type: object
      required:
      - id
      properties:
        id:
          description: The security group ID.
          type: string
    serverStatus:
      description: A server's status.
      type: object
      properties:
        privateIP:
          description: The private IP address of the server.
          type: string
        publicIP:
          description: The public IP address of the server.
          type: string
    serverRead:
      description: A server.
      type: object
      required:
      - metadata
      - spec
      - status
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/projectScopedResourceReadMetadata'
        spec:
          $ref: '#/components/schemas/serverSpec'
        status:
          $ref: '#/components/schemas/serverStatus'
    serverWrite:
      description: A server request.
      type: object
      required:
      - metadata
      - spec
      properties:
        metadata:
          $ref: 'https://raw.githubusercontent.com/unikorn-cloud/core/main/pkg/openapi/common.spec.yaml#/components/schemas/resourceWriteMetadata'
        spec:
          $ref: '#/components/schemas/serverSpec'
    serversRead:
      description: A list of servers.
      type: array
      items:
        $ref: '#/components/schemas/serverRead'
  requestBodies:
    identityRequest:
      description: A request for an identity.
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/identityWrite'
          example:
            metadata:
              name: identity-name
              description: A verbose description
              tags:
              - name: cluster-id
                value: 9361402c-f998-49cc-ab21-9bb99afcfde8
            spec:
              regionId: c7568e2d-f9ab-453d-9a3a-51375f78426b
    networkRequest:
      description: A request for a network.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/networkWrite'
          example:
            metadata:
              name: network-name
              description: A verbose description
              tags:
              - name: cluster-id
                value: 9361402c-f998-49cc-ab21-9bb99afcfde8
            spec:
              prefix: 192.168.0.0/24
              dnsNameservers:
              - 8.8.8.8
    securityGroupRequest:
      description: A request for a security group.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/securityGroupWrite'
          example:
            metadata:
              name: security-group-name
              description: A verbose description
              tags:
              - name: cluster-id
                value: 9361402c-f998-49cc-ab21-9bb99afcfde8
    securityGroupRuleRequest:
      description: A request for a security group rule.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/securityGroupRuleWrite'
          example:
            metadata:
              name: security-group-rule-name
              description: A verbose description
            spec:
              direction: ingress
              protocol: tcp
              port:
                number: 80
              cidr: 172.16.0.0/12
    serverRequest:
      description: A request for a server.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/serverWrite'
          example:
            metadata:
              name: server-name
              description: A verbose description
              tags:
              - name: tag-name
                value: tag-value
            spec:
              flavorId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              imageId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              securityGroups:
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9e
              publicIPAllocation:
                enabled: true
              networks:
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
                allowedAddressPairs:
                - cidr: 192.168.192.0/24
              userData: I2Nsb3VkLWNvbmZpZwpib290Y21kOgogLSBlY2hvIDE5Mi4xNjguMi45OSBteWhvc3QgPj4gL2V0Yy9ob3N0cwpwYWNrYWdlX3VwZ3JhZGU6IHRydWUKcGFja2FnZXM6CiAtIHZpbQo=
  responses:
    regionsResponse:
      description: A list of regions.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/regions'
          example:
          - metadata:
              id: c7568e2d-f9ab-453d-9a3a-51375f78426b
              name: uk-west-1
              description: A top secret datacenter somewhere in the UK
              creationTime: 2023-07-31T10:45:45Z
              provisioningStatus: provisioned
              healthStatus: healthy
            spec:
              type: openstack
              features:
                physicalNetworks: true
    regionDetailResponse:
      description: A detailed description of the region.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/regionDetailRead'
          example:
            metadata:
              id: c7568e2d-f9ab-453d-9a3a-51375f78426b
              name: uk-west
              description: A top secret datacenter somewhere in the UK
              creationTime: 2023-07-31T10:45:45Z
              provisioningStatus: provisioned
              healthStatus: healthy
            spec:
              type: kubernetes
              kubernetes:
                kubeconfig: Zm9v
              features:
                physicalNetworks: false
    imagesResponse:
      description: A list of images that are compatible with this platform.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/images'
          example:
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: ubu2204-v1.25.6-gpu-525.85.05-7ced4154
              creationTime: 2023-02-22T12:04:13Z
            spec:
              sizeGiB: 10
              virtualization: virtualized
              os:
                kernel: linux
                family: debian
                distro: ubuntu
                variant: server
                codename: noble
                version: '24.04'
              softwareVersions:
                kubernetes: v1.25.6
              gpu:
                vendor: NVIDIA
                driver: 525.85.05
                models:
                - A100
                - H100
                - H200
    flavorsResponse:
      description: A list of flavors.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/flavors'
          example:
          - metadata:
              id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              name: g.4.highmem.a100.1g.10gb
              creationTime: 1970-01-01T00:00:00Z
            spec:
              cpus: 4
              cpuFamily: Intel Xeon Platinum 8160T (Skylake)
              disk: 20
              memory: 32
              gpu:
                vendor: AMD
                model: Instinct MI250
                memory: 64
                physicalCount: 1
                logicalCount: 2
    identityResponse:
      description: An identity response.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/identityRead'
          example:
            metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: undefined
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              healthStatus: healthy
            spec:
              regionId: d891dbf0-0a01-4efc-ae3a-5d77f6d3424b
              type: openstack
              openstack:
                cloud: default
                cloudConfig: dGhpcyBpcyBhIHRlc3QK
                projectId: eb9c92d937464d14bf87e50fa726380d
                userId: a19678a28126497dba24b54c96a064fa
                sshKeyNmae: foo
    identitiesResponse:
      description: A list of identites.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/identitiesRead'
          example:
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: undefined
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              healthStatus: healthy
            spec:
              regionId: d891dbf0-0a01-4efc-ae3a-5d77f6d3424b
              type: openstack
              openstack:
                cloud: default
                cloudConfig: dGhpcyBpcyBhIHRlc3QK
                projectId: eb9c92d937464d14bf87e50fa726380d
                userId: a19678a28126497dba24b54c96a064fa
                sshKeyNmae: foo
    networkResponse:
      description: A network.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/networkRead'
          example:
            metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: undefined
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              healthStatus: healthy
            spec:
              regionId: d891dbf0-0a01-4efc-ae3a-5d77f6d3424b
              prefix: 192.168.0.0/24
              dnsNameservers:
              - 8.8.8.8
              type: openstack
              openstack:
                vlanId: 1024
                networkId: 824e8c4c-5858-4b02-9906-390e34561bf3
    networksResponse:
      description: A list of networks.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/networksRead'
          example:
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: undefined
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              healthStatus: healthy
            spec:
              regionId: d891dbf0-0a01-4efc-ae3a-5d77f6d3424b
              prefix: 192.168.0.0/24
              dnsNameservers:
              - 8.8.8.8
              type: openstack
              openstack:
                vlanId: 1024
                networkId: 824e8c4c-5858-4b02-9906-390e34561bf3
    externalNetworksResponse:
      description: A list of valid external networks.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/externalNetworks'
          example:
          - id: c3f92716-1fdc-4b7b-906e-4fe0154dfcdf
            name: foo
    securityGroupResponse:
      description: A security group.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/securityGroupRead'
          example:
            metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: undefined
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              healthStatus: healthy
            spec:
              regionId: d891dbf0-0a01-4efc-ae3a-5d77f6d3424b
    securityGroupsResponse:
      description: A list of security groups.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/securityGroupsRead'
          example:
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: undefined
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              healthStatus: healthy
            spec:
              regionId: d891dbf0-0a01-4efc-ae3a-5d77f6d3424b
    securityGroupRuleResponse:
      description: A security group rule.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/securityGroupRuleRead'
          example:
            metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: sg-name
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              healthStatus: healthy
            spec:
              direction: ingress
              protocol: tcp
              port:
                range:
                  start: 1066
                  end: 1999
              cidr: 172.16.0.0/12
    securityGroupRulesResponse:
      description: A list of security group rules.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/securityGroupRulesRead'
          example:
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: sg-name
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              healthStatus: healthy
            spec:
              direction: ingress
              protocol: tcp
              port:
                range:
                  start: 1066
                  end: 1999
              cidr: 172.16.0.0/12
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7d
              name: sg-name
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              healthStatus: healthy
            spec:
              direction: ingress
              protocol: tcp
              port:
                number: 80
              cidr: 0.0.0.0/0
    serverResponse:
      description: A server.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/serverRead'
          example:
            metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: server-name
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              healthStatus: healthy
              tags:
              - name: tag-name
                value: tag-value
            spec:
              flavorId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              imageId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              securityGroups:
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9e
              publicIPAllocation:
                enabled: true
              networks:
                - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              userData: I2Nsb3VkLWNvbmZpZwpib290Y21kOgogLSBlY2hvIDE5Mi4xNjguMi45OSBteWhvc3QgPj4gL2V0Yy9ob3N0cwpwYWNrYWdlX3VwZ3JhZGU6IHRydWUKcGFja2FnZXM6CiAtIHZpbQo=
            status:
              privateIP: 192.168.1.50
              publicIP: 142.250.66.196
    serversResponse:
      description: A list of servers.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/serversRead'
          example:
          - metadata:
              id: a64f9269-36e0-4312-b8d1-52d93d569b7b
              name: server-name
              organizationId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              projectId: e36c058a-8eba-4f5b-91f4-f6ffb983795c
              creationTime: 2024-05-31T14:11:00Z
              createdBy: john.doe@acme.com
              provisioningStatus: provisioned
              healthStatus: healthy
              tags:
              - name: tag-name
                value: tag-value
            spec:
              flavorId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              imageId: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              securityGroups:
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9e
              publicIPAllocation:
                enabled: true
              networks:
              - id: 9a8c6370-4065-4d4a-9da0-7678df40cd9d
              userData: I2Nsb3VkLWNvbmZpZwpib290Y21kOgogLSBlY2hvIDE5Mi4xNjguMi45OSBteWhvc3QgPj4gL2V0Yy9ob3N0cwpwYWNrYWdlX3VwZ3JhZGU6IHRydWUKcGFja2FnZXM6CiAtIHZpbQo=
            status:
              privateIP: 192.168.1.50
              publicIP: 142.250.66.196
  securitySchemes:
    oauth2Authentication:
      description: Operation requires OAuth 2.0 bearer token authentication.
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://identity.nks.europe-west4.nscale.com/oauth2/v2/authorization
          tokenUrl: https://identity.nks.europe-west4.nscale.com/oauth2/v2/token
          scopes: {}
